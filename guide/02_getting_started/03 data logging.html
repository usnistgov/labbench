<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Data Logging &#8212; labbench</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../../_static/pyramid.css?v=6f14c262" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.06696a45b937849642cfa8e412e8bfb79927fd8cf52bbc9bf40c63c5e8cfefe3.css?v=be8a1c11" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=7bb76a1a"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Simplified Concurrency" href="04%20concurrency.html" />
    <link rel="prev" title="Procedural Snippets" href="02%20rack.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>
<header class="nist-header">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>NIST Pages Template</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="labbench">
  <link rel="canonical" href="../../">
  <link rel="shortcut icon" href="/favicon.ico">

  <!-- Google Analytics -->
  <!--<script type="text/javascript" id="_fed_an_js_tag" src="http://www.nist.gov/js/federated-analytics.all.min.js?agency=NIST&subagency=mml&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script> -->
  <!-- DAP Analytics -->
  <script type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DOC&subagefncy=NIST&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="../..//_static/NISTStyle.css">
  <link rel="stylesheet" href="../..//_static/NISTPages.css">

  <h1>
    <a class="nist-logo" target="_blank" href="http://www.nist.gov/" title="Go to nist.gov">National Institute of Standards and Technology</a>
  </h1>
  <div class="nist-links">
    <a class="nist-links-button" target="_blank" href="http://www.nist.gov">NIST Website</a>
    <a class="nist-links-button mobile-hide" target="_blank" href="http://www.nist.gov/public_affairs/nandyou.cfm">About NIST</a>
    <a class="nist-links-button mobile-hide" target="_blank" href="https://github.com/usnistgov">usnistgov on GitHub</a>
  </div>
  
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
</header>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="04%20concurrency.html" title="Simplified Concurrency"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="02%20rack.html" title="Procedural Snippets"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">labbench</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../02_getting_started.html" accesskey="U">Getting Started</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Data Logging</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="data-logging">
<h1>Data Logging<a class="headerlink" href="#data-logging" title="Permalink to this heading">¶</a></h1>
<p>Several objects are included in <code class="docutils literal notranslate"><span class="pre">labbench</span></code> for logging test conditions and resulting measurement results.</p>
<ul class="simple">
<li><p>Automatic logging of interactions with <code class="docutils literal notranslate"><span class="pre">Device</span></code> attributes that are defined with <a class="reference internal" href="../../labbench.property.html#module-labbench.property" title="labbench.property"><code class="xref py py-mod docutils literal notranslate"><span class="pre">labbench.property</span></code></a>, <a class="reference internal" href="../../labbench.value.html#module-labbench.value" title="labbench.value"><code class="xref py py-mod docutils literal notranslate"><span class="pre">labbench.value</span></code></a>, and <a class="reference internal" href="../../labbench.datareturn.html#module-labbench.datareturn" title="labbench.datareturn"><code class="xref py py-mod docutils literal notranslate"><span class="pre">labbench.datareturn</span></code></a></p></li>
<li><p>Manual logging through simple dictionary mapping
The data model is driven by a root table of test conditions and measurement results, with relational tables when necessary. In the root table, each row represents a test condition. Common non-scalar data types (<code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.array()</span></code>, long strings, files generated outside the data tree, etc.) are automatically stored in folders, which are referred to by relative file paths in the database.</p></li>
</ul>
<p>Logging is provided for specific root data formats through <a class="reference internal" href="../../labbench.html#labbench.CSVLogger" title="labbench.CSVLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">labbench.CSVLogger</span></code></a>, <a class="reference internal" href="../../labbench.html#labbench.HDFLogger" title="labbench.HDFLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">labbench.HDFLogger</span></code></a>, and <a class="reference internal" href="../../labbench.html#labbench.SQLiteLogger" title="labbench.SQLiteLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">labbench.SQLiteLogger</span></code></a>.</p>
<section id="example-logging-with-device-objects-in-scripts">
<h2>Example: Logging with <code class="docutils literal notranslate"><span class="pre">Device</span></code> objects in scripts<a class="headerlink" href="#example-logging-with-device-objects-in-scripts" title="Permalink to this heading">¶</a></h2>
<p>The use of logging objects requires some light configuration, and one call to add data per test row.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">labbench</span> <span class="k">as</span> <span class="nn">lb</span>
<span class="kn">from</span> <span class="nn">labbench.testing</span> <span class="kn">import</span> <span class="n">SpectrumAnalyzer</span><span class="p">,</span> <span class="n">PowerSensor</span><span class="p">,</span> <span class="n">pyvisa_sim_resource</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">shutil</span><span class="o">,</span> <span class="nn">time</span>

<span class="n">FREQ_COUNT</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">DUT_NAME</span> <span class="o">=</span> <span class="s2">&quot;DUT 63&quot;</span>
<span class="n">DATA_PATH</span> <span class="o">=</span> <span class="s1">&#39;./data&#39;</span>

<span class="c1"># the labbench.testing devices support simulated pyvisa operations</span>
<span class="n">lb</span><span class="o">.</span><span class="n">visa_default_resource_manager</span><span class="p">(</span><span class="n">pyvisa_sim_resource</span><span class="p">)</span>
<span class="n">lb</span><span class="o">.</span><span class="n">show_messages</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>

<span class="n">sensor</span> <span class="o">=</span> <span class="n">PowerSensor</span><span class="p">()</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">SpectrumAnalyzer</span><span class="p">()</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">CSVLogger</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;./data&quot;</span><span class="p">)</span>

<span class="c1"># automatic logging from `analyzer` in &#39;output.csv&#39; in each call to db.new_row:</span>
<span class="c1"># (1) each lb.property or lb.value that has been get or set in the device since the last call</span>
<span class="n">db</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">analyzer</span><span class="p">)</span>

<span class="c1"># automatic logging from `sensor` in &#39;output.csv&#39; in each call to db.new_row:</span>
<span class="c1"># (1) each lb.property or lb.value that has been get or set in the device since the last call</span>
<span class="c1"># (2) explicitly get `sensor.sweep_aperture` (as column &quot;sensor_sweep_aperture&quot;)</span>
<span class="n">db</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">sensor</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sweep_aperture&#39;</span><span class="p">])</span>

<span class="k">with</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">analyzer</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">5.8e9</span><span class="p">,</span> <span class="mf">5.9e9</span><span class="p">,</span> <span class="n">FREQ_COUNT</span><span class="p">):</span>
        <span class="c1"># Assignment to these property attributes:</span>
        <span class="c1"># (1) sets the frequency on each instrument *and*</span>
        <span class="c1"># (2) triggers logging of these values in the next database row in</span>
        <span class="c1">#     the columns &#39;analyzer_center_frequency&#39; and &#39;sensor_frequency&#39;</span>
        <span class="n">analyzer</span><span class="o">.</span><span class="n">center_frequency</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="n">sensor</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="n">freq</span>

        <span class="n">sensor</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span>
        <span class="n">analyzer</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span>

        <span class="c1"># Logs the measurements and test conditions as a new row. Each key</span>
        <span class="c1"># is a column in the database in addition to the automatic parameters</span>
        <span class="n">db</span><span class="o">.</span><span class="n">new_row</span><span class="p">(</span>
            <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;trying for 1.21 GW to time travel&#39;</span><span class="p">,</span>
            <span class="n">dut</span> <span class="o">=</span> <span class="n">DUT_NAME</span><span class="p">,</span>
            <span class="n">analyzer_trace</span><span class="o">=</span><span class="n">analyzer</span><span class="o">.</span><span class="n">fetch</span><span class="p">(),</span>
            <span class="n">sensor_reading</span><span class="o">=</span><span class="n">sensor</span><span class="o">.</span><span class="n">fetch</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Black"> INFO  </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.720</span> • <span class=" -Color -Color-Blue">Aggregator():</span> SpectrumAnalyzer(&#39;&#39;) named &#39;analyzer&#39; by introspection
<span class=" -Color -Color-Bold -Color-Bold-Black"> INFO  </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.723</span> • <span class=" -Color -Color-Blue">Aggregator():</span> PowerSensor(&#39;&#39;) named &#39;sensor&#39; by introspection
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.770</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">resource identified with identity pattern match &quot;Power Sensor model #1234, Serial 63472&quot;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.771</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait set: &quot;resource&quot; → &#39;USB0::0x1111::0x2222::0x1234::0::INSTR&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.772</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">opened</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.773</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">resource identified with identity pattern match &quot;Spectrum analyzer model #1234, Serial #AUJH99&quot;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.773</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait set: &quot;resource&quot; → &#39;USB0::0x1111::0x2222::0x4445::0::INSTR&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.774</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">opened</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.774</span> • <span class=" -Color -Color-Blue">CSVLogger(&#39;data&#39;):</span> <span class=" -Color -Color-Green">entry_order before other devices: Email -&gt; MungerBase -&gt; Host</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.775</span> • <span class=" -Color -Color-Blue">CSVLogger(&#39;data&#39;):</span> <span class=" -Color -Color-Green">context order: munge-&gt;host-&gt;()-&gt;(CSVLogger(&#39;data&#39;))</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.777</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;SENS:FREQ 5800000000.0&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.777</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait set: &quot;center_frequency&quot; → 5800000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.778</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;SENS:FREQ 5800000000.0&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.778</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait set: &quot;frequency&quot; → 5800000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.779</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;TRIG&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.779</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;TRIG&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.780</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;FETC?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.782</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → (1572 bytes)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.783</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;SENS:FREQ?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.783</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;5800000000.000000&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.784</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;center_frequency&quot; → 5800000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.784</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;FETC?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.786</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → (1572 bytes)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.787</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;TRIG:COUN?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.788</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;200&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.789</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;trigger_count&quot; → 200 (samples)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.790</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;SWE:APER?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.790</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;0.020000&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.791</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;sweep_aperture&quot; → 0.02 (s)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.791</span> • <span class=" -Color -Color-Blue">CSVLogger(&#39;data&#39;):</span> <span class=" -Color -Color-Green">new data row has 8 columns</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.792</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;SENS:FREQ 5850000000.0&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.792</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait set: &quot;center_frequency&quot; → 5850000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.793</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;SENS:FREQ 5850000000.0&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.793</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait set: &quot;frequency&quot; → 5850000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.794</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;TRIG&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.794</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;TRIG&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.795</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;FETC?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.797</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → (1572 bytes)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.798</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;SENS:FREQ?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.799</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;5850000000.000000&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.799</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;center_frequency&quot; → 5850000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.800</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;FETC?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.802</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → (1572 bytes)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.802</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;TRIG:COUN?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.803</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;200&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.803</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;trigger_count&quot; → 200 (samples)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.804</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;SWE:APER?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.805</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;0.020000&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.805</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;sweep_aperture&quot; → 0.02 (s)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.806</span> • <span class=" -Color -Color-Blue">CSVLogger(&#39;data&#39;):</span> <span class=" -Color -Color-Green">new data row has 8 columns</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.806</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;SENS:FREQ 5900000000.0&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.807</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait set: &quot;center_frequency&quot; → 5900000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.808</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;SENS:FREQ 5900000000.0&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.808</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait set: &quot;frequency&quot; → 5900000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.809</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;TRIG&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.809</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">write &#39;TRIG&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.810</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;FETC?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.812</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → (1572 bytes)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.813</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;SENS:FREQ?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.814</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;5900000000.000000&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.814</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;center_frequency&quot; → 5900000000.0 (Hz)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.815</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;FETC?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.817</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → (1572 bytes)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.817</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;TRIG:COUN?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.818</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;200&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.818</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;trigger_count&quot; → 200 (samples)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.819</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">query &#39;SWE:APER?&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.820</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">    → &#39;0.020000&#39;</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.821</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">trait get: &quot;sweep_aperture&quot; → 0.02 (s)</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.822</span> • <span class=" -Color -Color-Blue">CSVLogger(&#39;data&#39;):</span> <span class=" -Color -Color-Green">new data row has 8 columns</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.822</span> • <span class=" -Color -Color-Blue">SpectrumAnalyzer(&#39;&#39;):</span> <span class=" -Color -Color-Green">closed</span>
<span class=" -Color -Color-Bold -Color-Bold-Black"> DEBUG </span> <span class=" -Color -Color-Green">2023-09-22 14:43:20.823</span> • <span class=" -Color -Color-Blue">PowerSensor(&#39;&#39;):</span> <span class=" -Color -Color-Green">closed</span>
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">28</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span> <span class="c1"># automatic logging from `sensor` in &#39;output.csv&#39; in each call to db.new_row:</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span> <span class="c1"># (1) each lb.property or lb.value that has been get or set in the device since the last call</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span> <span class="c1"># (2) explicitly get `sensor.sweep_aperture` (as column &quot;sensor_sweep_aperture&quot;)</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span> <span class="n">db</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">sensor</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sweep_aperture&#39;</span><span class="p">])</span>
<span class="ne">---&gt; </span><span class="mi">28</span> <span class="k">with</span> <span class="n">sensor</span><span class="p">,</span> <span class="n">analyzer</span><span class="p">,</span> <span class="n">db</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">29</span>     <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">5.8e9</span><span class="p">,</span> <span class="mf">5.9e9</span><span class="p">,</span> <span class="n">FREQ_COUNT</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span>         <span class="c1"># Assignment to these property attributes:</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>         <span class="c1"># (1) sets the frequency on each instrument *and*</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>         <span class="c1"># (2) triggers logging of these values in the next database row in</span>
<span class="g g-Whitespace">     </span><span class="mi">33</span>         <span class="c1">#     the columns &#39;analyzer_center_frequency&#39; and &#39;sensor_frequency&#39;</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span>         <span class="n">analyzer</span><span class="o">.</span><span class="n">center_frequency</span> <span class="o">=</span> <span class="n">freq</span>

<span class="nn">File ~\Documents\src\labbench\labbench\util.py:872,</span> in <span class="ni">MultipleContexts.__exit__</span><span class="nt">(self, *exc)</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="n">exc_info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exc</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">872</span>     <span class="k">raise</span> <span class="n">exc_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">873</span> <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>     <span class="n">ex</span> <span class="o">=</span> <span class="n">ConcurrentException</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>         <span class="sa">f</span><span class="s2">&quot;exceptions raised in </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="s2"> contexts are printed inline&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>     <span class="p">)</span>

<span class="nn">File ~\Documents\src\labbench\labbench\util.py:702,</span> in <span class="ni">Call.__call__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">699</span> <span class="nd">@hide_in_traceback</span>
<span class="g g-Whitespace">    </span><span class="mi">700</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">701</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">702</span>         <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kws</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">704</span>         <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nn">File ~\Documents\src\labbench\labbench\util.py:809,</span> in <span class="ni">MultipleContexts.enter</span><span class="nt">(self, name, context)</span>
<span class="g g-Whitespace">    </span><span class="mi">806</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">807</span>     <span class="c1"># proceed only if there have been no exceptions</span>
<span class="g g-Whitespace">    </span><span class="mi">808</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">809</span>         <span class="n">context</span><span class="o">.</span><span class="fm">__enter__</span><span class="p">()</span>  <span class="c1"># start of a context entry thread</span>
<span class="g g-Whitespace">    </span><span class="mi">810</span>     <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">811</span>         <span class="bp">self</span><span class="o">.</span><span class="n">abort</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File ~\Documents\src\labbench\labbench\_device.py:384,</span> in <span class="ni">Device.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">382</span>     <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span>     <span class="n">e</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">384</span> <span class="k">raise</span> <span class="n">e</span>

<span class="nn">File ~\Documents\src\labbench\labbench\_device.py:377,</span> in <span class="ni">Device.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">374</span> <span class="nd">@util</span><span class="o">.</span><span class="n">hide_in_traceback</span>
<span class="g g-Whitespace">    </span><span class="mi">375</span> <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">377</span>         <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">378</span>         <span class="k">return</span> <span class="bp">self</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span>     <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">File ~\Documents\src\labbench\labbench\_device.py:321,</span> in <span class="ni">Device.__open_wrapper__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span>     <span class="k">for</span> <span class="n">opener</span> <span class="ow">in</span> <span class="n">trace_methods</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">Device</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">321</span>         <span class="n">opener</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span> <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>     <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">=</span> <span class="n">DisconnectedBackend</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="nn">File ~\Documents\src\labbench\labbench\_data.py:325,</span> in <span class="ni">MungerBase.open</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span> <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span>     <span class="c1"># touch these modules to ensure they have imported</span>
<span class="ne">--&gt; </span><span class="mi">325</span>     <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>     <span class="n">np</span><span class="o">.</span><span class="n">array</span>

<span class="nn">File C:\Python310\lib\importlib\util.py:252,</span> in <span class="ni">_LazyModule.__getattribute__</span><span class="nt">(self, attr)</span>
<span class="g g-Whitespace">    </span><span class="mi">250</span> <span class="k">if</span> <span class="n">original_name</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">251</span>     <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">id</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">original_name</span><span class="p">]):</span>
<span class="ne">--&gt; </span><span class="mi">252</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;module object for </span><span class="si">{</span><span class="n">original_name</span><span class="si">!r}</span><span class="s2"> &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span>                           <span class="s2">&quot;substituted in sys.modules during a lazy &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">254</span>                           <span class="s2">&quot;load&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">255</span> <span class="c1"># Update after loading since that&#39;s what would happen in an eager</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span> <span class="c1"># loading situation.</span>
<span class="g g-Whitespace">    </span><span class="mi">257</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">attrs_updated</span><span class="p">)</span>

<span class="ne">ValueError</span>: MungeToDirectory(&#39;data&#39;): module object for &#39;pandas&#39; substituted in sys.modules during a lazy load
</pre></div>
</div>
</div>
</div>
<section id="reading-and-exploring-the-data">
<h3>Reading and exploring the data<a class="headerlink" href="#reading-and-exploring-the-data" title="Permalink to this heading">¶</a></h3>
<p>The master database is now populated with the test results and subdirectories are populated with trace data. The function <a class="reference internal" href="../../labbench.html#labbench.read" title="labbench.read"><code class="xref py py-class docutils literal notranslate"><span class="pre">labbench.read</span></code></a> loads a the table of measurement results into a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/">pandas</a> data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">db</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s1">/outputs.csv&#39;</span><span class="p">)</span>
<span class="n">root</span>
</pre></div>
</div>
</div>
</div>
<p>This is a relational data table: non-scalar data (arrays, tables, etc.) and long text strings are replaced with relative paths to files where data is stored. Examples here include the measurement trace from the spectrum analyzer (column <code class="docutils literal notranslate"><span class="pre">'analyzer_trace.csv'</span></code>), and the host log JSON file (‘host_log).</p>
<p>To analyze the experimental data, one approach is to access these files directly at these files</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rel_path</span> <span class="o">=</span> <span class="n">root</span><span class="p">[</span><span class="s1">&#39;analyzer_trace&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">lb</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">db</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">rel_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>For a more systematic analysis to analyzing the data, we may want to expand the root table based on the relational data files in one of these columns. A shortcut for this is provided by <a class="reference internal" href="../../labbench.html#labbench.read_relational" title="labbench.read_relational"><code class="xref py py-func docutils literal notranslate"><span class="pre">labbench.read_relational()</span></code></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lb</span><span class="o">.</span><span class="n">read_relational</span><span class="p">(</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">db</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s1">/outputs.csv&#39;</span><span class="p">,</span>

    <span class="c1"># the column containing paths to relational data tables.</span>
    <span class="c1"># the returned table places a .</span>
    <span class="s1">&#39;analyzer_trace&#39;</span><span class="p">,</span>

    <span class="c1"># copy fixed values of these column across as columns in each relational data table</span>
    <span class="p">[</span><span class="s1">&#39;sensor_frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;sensor_sweep_aperture&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For each row in the root table, the expanded table is expanded with a copy of the contents of the relational data table in its file path ending in <code class="docutils literal notranslate"><span class="pre">'analyzer_trace.csv'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">labbench</span> <span class="k">as</span> <span class="nn">lb</span>
<span class="kn">from</span> <span class="nn">labbench.testing</span> <span class="kn">import</span> <span class="n">SpectrumAnalyzer</span><span class="p">,</span> <span class="n">PowerSensor</span><span class="p">,</span> <span class="n">SignalGenerator</span><span class="p">,</span> <span class="n">pyvisa_sim_resource</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">rmtree</span>

<span class="n">FREQ_COUNT</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">DUT_NAME</span> <span class="o">=</span> <span class="s2">&quot;DUT 63&quot;</span>
<span class="n">DATA_PATH</span> <span class="o">=</span> <span class="s1">&#39;./data&#39;</span>


<span class="c1"># the labbench.testing devices support simulated pyvisa operations</span>
<span class="n">lb</span><span class="o">.</span><span class="n">visa_default_resource_manager</span><span class="p">(</span><span class="n">pyvisa_sim_resource</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Testbed</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">Rack</span><span class="p">):</span>
    <span class="n">sensor</span><span class="p">:</span> <span class="n">PowerSensor</span> <span class="o">=</span> <span class="n">PowerSensor</span><span class="p">()</span>
    <span class="n">analyzer</span><span class="p">:</span> <span class="n">SpectrumAnalyzer</span> <span class="o">=</span> <span class="n">SpectrumAnalyzer</span><span class="p">()</span>
    <span class="n">db</span><span class="p">:</span> <span class="n">lb</span><span class="o">.</span><span class="n">CSVLogger</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">CSVLogger</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">DATA_PATH</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># remove prior data before we start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sweep_aperture&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">center_frequency</span> <span class="o">=</span> <span class="n">frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="n">frequency</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">trigger</span><span class="p">()</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">analyzer_trace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">fetch</span><span class="p">(),</span>
            <span class="n">sensor_reading</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor</span><span class="o">.</span><span class="n">fetch</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>

<span class="n">rmtree</span><span class="p">(</span><span class="n">Testbed</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="k">with</span> <span class="n">Testbed</span><span class="p">()</span> <span class="k">as</span> <span class="n">rack</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">5.8e9</span><span class="p">,</span> <span class="mf">5.9e9</span><span class="p">,</span> <span class="n">FREQ_COUNT</span><span class="p">):</span>
        <span class="n">rack</span><span class="o">.</span><span class="n">single</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>

        <span class="c1"># this could also go in single()</span>
        <span class="n">rack</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">new_row</span><span class="p">(</span>
            <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;trying for 1.21 GW to time travel&#39;</span><span class="p">,</span>
            <span class="n">dut</span> <span class="o">=</span> <span class="n">DUT_NAME</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Data Logging</a><ul>
<li><a class="reference internal" href="#example-logging-with-device-objects-in-scripts">Example: Logging with <code class="docutils literal notranslate"><span class="pre">Device</span></code> objects in scripts</a><ul>
<li><a class="reference internal" href="#reading-and-exploring-the-data">Reading and exploring the data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="02%20rack.html"
                          title="previous chapter">Procedural Snippets</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="04%20concurrency.html"
                          title="next chapter">Simplified Concurrency</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/guide/02_getting_started/03 data logging.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="04%20concurrency.html" title="Simplified Concurrency"
             >next</a> |</li>
        <li class="right" >
          <a href="02%20rack.html" title="Procedural Snippets"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">labbench</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../02_getting_started.html" >Getting Started</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Data Logging</a></li> 
      </ul>
    </div>
<hr \>
<section class="footer">
<br><a target="_blank" href="http://www.nist.gov/public_affairs/privacy.cfm#privpolicy">Privacy Policy</a> | <a target="_blank" href="http://www.nist.gov/public_affairs/privacy.cfm#secnot">Security Notice</a> | <a href="http://www.nist.gov/public_affairs/privacy.cfm#accesstate">Accessibility Statement</a>
<br><em>United States government work, not subject to copyright in the United States</em>
</section>

  </body>
</html>