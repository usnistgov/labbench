# simulated device definitions for documentation and testing with pyvisa-sim

spec: "1.0"

devices:
  PowerSensor:
    eom:
      ASRL INSTR:
        q: "\r\n"
        r: "\n"
      USB INSTR:
        q: "\r\n"
        r: "\n"
      TCPIP INSTR:
        q: "\r\n"
        r: "\n"
      TCPIP SOCKET:
        q: "\r\n"
        r: "\n"
      GPIB INSTR:
        q: "\r\n"
        r: "\n"
    error:
      # response:
      #   command_error: null_response
      status_register:
        - q: "*ESR?"
          command_error: 32
          query_error: 4
    dialogues:
      - q: "*IDN?"
        r: "FakeTech,Power Sensor #1234,63472,rev f"
      - q: "SYST:PRES"
      - q: "*RST"
      - q: "TRIG"
      - q: 'FETC?'
        r: "-52.617,-52.373,-52.724,-51.893,-52.27,-52.047,-53.059,-52.053,-52.426,-52.343,-52.228,-52.976,-52.186,-53.0,-51.894,-53.18,-51.96,-52.326,-52.492,-52.871,-52.41,-53.111,-53.199,-52.907,-52.791,-52.68,-51.63,-51.679,-51.743,-52.613,-52.108,-53.138,-52.014,-52.289,-52.235,-52.26,-53.135,-52.503,-52.201,-51.633,-51.933,-52.82,-52.287,-52.594,-51.89,-52.371,-52.068,-51.888,-53.145,-53.085,-52.392,-52.064,-51.688,-52.188,-52.211,-52.226,-52.841,-51.951,-51.573,-51.521,-52.115,-52.302,-52.958,-52.503,-52.32,-52.81,-52.357,-51.729,-52.956,-52.849,-51.883,-51.505,-52.027,-52.234,-52.092,-51.446,-52.798,-51.601,-52.14,-51.477,-52.614,-52.291,-52.532,-52.861,-51.814,-51.821,-52.997,-53.184,-51.761,-53.052,-51.612,-52.876,-52.013,-52.252,-52.059,-52.806,-52.474,-51.689,-52.606,-51.924,-51.964,-51.601,-52.815,-53.172,-52.183,-53.071,-52.763,-52.999,-52.595,-52.463,-52.48,-52.701,-52.337,-51.778,-52.039,-51.493,-51.591,-51.654,-51.525,-52.925,-51.531,-53.169,-52.997,-52.519,-52.298,-52.078,-52.547,-51.518,-51.589,-51.567,-51.502,-51.984,-52.215,-52.681,-51.468,-53.197,-53.007,-51.929,-52.465,-53.132,-52.073,-51.75,-52.8,-52.054,-52.493,-51.605,-53.026,-52.28,-52.331,-52.109,-51.889,-52.878,-51.874,-51.801,-52.031,-52.625,-51.84,-53.029,-52.431,-51.655,-52.51,-52.431,-52.165,-52.009,-51.973,-53.042,-52.632,-51.754,-52.637,-51.757,-51.9,-52.775,-52.49,-52.022,-52.151,-52.05,-51.867,-52.494,-53.014,-52.14,-53.036,-51.799,-51.848,-51.996,-52.254,-52.75,-51.492,-51.755,-52.494,-53.193,-53.114,-53.028,-52.898,-52.992,-53.127,-51.752,-53.065,-52.585,-51.861,-51.596"

    properties:
      initiate_continuous:
        default: 'OFF'
        getter:
          q: "INIT:CONT?"
          r: "{:s}"
        setter:
          q: "INIT:CONT {:s}"
        specs:
            valid: ["ON", "OFF"]
            type: str

      measurement_rate:
        default: 'NORM'
        getter:
          q: "SENS:MRAT?"
          r: "{:s}"
        setter:
          q: "SENS:MRAT {:s}"
        specs:
            valid: ["NORM", "DOUB", "FAST"]
            type: str

      # fixed since we can't dynamically generate FETC?
      trigger_count:
        default: 1
        getter:
          q: "TRIG:COUN?"
          r: "{}"
        setter:
          q: "TRIG:COUN {}"
          # r: OK
        specs:
          min: 1
          max: 200
          type: int

      sweep_aperture:
        default: 20e-3
        getter:
          q: "SWE:APER?"
          r: "{:f}"
        setter:
          q: "SWE:APER {:f}"
          # r: OK
        specs:
          min: 20e-6
          max: 200e-3
          type: float

      frequency:
        default: 10e6
        getter:
          q: "SENS:FREQ?"
          r: "{:f}"
        setter:
          q: "SENS:FREQ {:f}"
        specs:
          min: 10e6
          max: 18e9
          type: float

  SpectrumAnalyzer:
    eom:
      ASRL INSTR:
        q: "\r\n"
        r: "\n"
      USB INSTR:
        q: "\n"
        r: "\n"
      TCPIP INSTR:
        q: "\n"
        r: "\n"
      TCPIP SOCKET:
        q: "\n"
        r: "\n"
      GPIB INSTR:
        q: "\n"
        r: "\n"
    error:
      status_register:
        - q: "*ESR?"
          command_error: 32
          query_error: 4

    dialogues:
      - q: "*IDN?"
        r: "FakeTech,Spectrum Analyzer #1234,#AUJH99,v 4.3.1"
      - q: "TRIG"
      - q: "*RST"
      - q: 'FETC?'
        r: "-52.617,-52.373,-52.724,-51.893,-52.27,-52.047,-53.059,-52.053,-52.426,-52.343,-52.228,-52.976,-52.186,-53.0,-51.894,-53.18,-51.96,-52.326,-52.492,-52.871,-52.41,-53.111,-53.199,-52.907,-52.791,-52.68,-51.63,-51.679,-21.743,-52.613,-52.108,-53.138,-52.014,-52.289,-52.235,-52.26,-53.135,-52.503,-52.201,-51.633,-51.933,-52.82,-52.287,-52.594,-51.89,-52.371,-52.068,-51.888,-53.145,-53.085,-52.392,-52.064,-51.688,-52.188,-52.211,-52.226,-52.841,-51.951,-51.573,-51.521,-52.115,-52.302,-52.958,-52.503,-52.32,-52.81,-52.357,-51.729,-52.956,-52.849,-51.883,-51.505,-52.027,-52.234,-52.092,-51.446,-52.798,-51.601,-52.14,-51.477,-52.614,-52.291,-52.532,-52.861,-51.814,-51.821,-52.997,-53.184,-51.761,-53.052,-51.612,-52.876,-52.013,-52.252,-52.059,-52.806,-52.474,-51.689,-52.606,-51.924,-51.964,-51.601,-52.815,-53.172,-52.183,-53.071,-52.763,-52.999,-52.595,-52.463,-52.48,-52.701,-52.337,-51.778,-52.039,-51.493,-51.591,-51.654,-51.525,-52.925,-51.531,-53.169,-52.997,-52.519,-52.298,-52.078,-52.547,-51.518,-51.589,-51.567,-51.502,-51.984,-52.215,-52.681,-51.468,-53.197,-53.007,-51.929,-52.465,-53.132,-52.073,-51.75,-52.8,-52.054,-52.493,-51.605,-53.026,-52.28,-52.331,-52.109,-51.889,-52.878,-51.874,-51.801,-52.031,-52.625,-51.84,-53.029,-52.431,-51.655,-52.51,-52.431,-52.165,-52.009,-51.973,-53.042,-52.632,-51.754,-52.637,-51.757,-51.9,-52.775,-52.49,-52.022,-52.151,-52.05,-51.867,-52.494,-53.014,-52.14,-53.036,-51.799,-51.848,-51.996,-52.254,-52.75,-51.492,-51.755,-52.494,-53.193,-53.114,-53.028,-52.898,-52.992,-53.127,-51.752,-53.065,-52.585,-51.861,-51.596"

    properties:
      load_state:
        default: 'None'
        setter:
          q: "LOAD '{:s}'"
        specs:
            type: str

      resolution_bandwidth:
        default: 30e3
        getter:
          q: "SENS:BW?"
          r: "{:f}"
        setter:
          q: "SENS:BW {:f}"
        specs:
          min: 1
          max: 40e6
          type: float

      center_frequency:
        default: 10e6
        getter:
          q: "SENS:FREQ?"
          r: "{:f}"
        setter:
          q: "SENS:FREQ {:f}"
        specs:
          min: 10e6
          max: 18e9
          type: float

  Oscilloscope:
    eom:
      ASRL INSTR:
        q: "\r\n"
        r: "\n"
      USB INSTR:
        q: "\n"
        r: "\n"
      TCPIP INSTR:
        q: "\n"
        r: "\n"
      TCPIP SOCKET:
        q: "\n"
        r: "\n"
      GPIB INSTR:
        q: "\n"
        r: "\n"
    error:
      status_register:
        - q: "*ESR?"
          command_error: 32
          query_error: 4

    dialogues:
      - q: "*IDN?"
        r: "FakeTech,Oscilloscope #1234,OMGBBQ58,b.4"
      - q: "TRIG"
      - q: "*RST"
      - q: 'FETC?'
        r: "-52.617,-52.373,-52.724,-51.893,-52.27,-52.047,-53.059,-52.053,-52.426,-52.343,-52.228,-52.976,-52.186,-53.0,-51.894,-53.18,-51.96,-52.326,-52.492,-52.871,-52.41,-53.111,-53.199,-52.907,-52.791,-52.68,-51.63,-51.679,-21.743,-52.613,-52.108,-53.138,-52.014,-52.289,-52.235,-52.26,-53.135,-52.503,-52.201,-51.633,-51.933,-52.82,-52.287,-52.594,-51.89,-52.371,-52.068,-51.888,-53.145,-53.085,-52.392,-52.064,-51.688,-52.188,-52.211,-52.226,-52.841,-51.951,-51.573,-51.521,-52.115,-52.302,-52.958,-52.503,-52.32,-52.81,-52.357,-51.729,-52.956,-52.849,-51.883,-51.505,-52.027,-52.234,-52.092,-51.446,-52.798,-51.601,-52.14,-51.477,-52.614,-52.291,-52.532,-52.861,-51.814,-51.821,-52.997,-53.184,-51.761,-53.052,-51.612,-52.876,-52.013,-52.252,-52.059,-52.806,-52.474,-51.689,-52.606,-51.924,-51.964,-51.601,-52.815,-53.172,-52.183,-53.071,-52.763,-52.999,-52.595,-52.463,-52.48,-52.701,-52.337,-51.778,-52.039,-51.493,-51.591,-51.654,-51.525,-52.925,-51.531,-53.169,-52.997,-52.519,-52.298,-52.078,-52.547,-51.518,-51.589,-51.567,-51.502,-51.984,-52.215,-52.681,-51.468,-53.197,-53.007,-51.929,-52.465,-53.132,-52.073,-51.75,-52.8,-52.054,-52.493,-51.605,-53.026,-52.28,-52.331,-52.109,-51.889,-52.878,-51.874,-51.801,-52.031,-52.625,-51.84,-53.029,-52.431,-51.655,-52.51,-52.431,-52.165,-52.009,-51.973,-53.042,-52.632,-51.754,-52.637,-51.757,-51.9,-52.775,-52.49,-52.022,-52.151,-52.05,-51.867,-52.494,-53.014,-52.14,-53.036,-51.799,-51.848,-51.996,-52.254,-52.75,-51.492,-51.755,-52.494,-53.193,-53.114,-53.028,-52.898,-52.992,-53.127,-51.752,-53.065,-52.585,-51.861,-51.596"

    properties:
      load_state:
        default: 'None'
        setter:
          q: "LOAD '{:s}'"
        specs:
            type: str

      channel_1_resolution_bandwidth:
        default: 30e3
        getter:
          q: "CH1:SENS:BW?"
          r: "{:f}"
        setter:
          q: "CH1:SENS:BW {:f}"
        specs:
          min: 1
          max: 40e6
          type: float

      channel_2_resolution_bandwidth:
        default: 30e3
        getter:
          q: "CH2:SENS:BW?"
          r: "{:f}"
        setter:
          q: "CH2:SENS:BW {:f}"
        specs:
          min: 1
          max: 40e6
          type: float

      channel_3_resolution_bandwidth:
        default: 30e3
        getter:
          q: "CH3:SENS:BW?"
          r: "{:f}"
        setter:
          q: "CH3:SENS:BW {:f}"
        specs:
          min: 1
          max: 40e6
          type: float

      channel_4_resolution_bandwidth:
        default: 30e3
        getter:
          q: "CH4:SENS:BW?"
          r: "{:f}"
        setter:
          q: "CH4:SENS:BW {:f}"
        specs:
          min: 1
          max: 40e6
          type: float

      channel_1_center_frequency:
        default: 10e6
        getter:
          q: "CH1:SENS:FREQ?"
          r: "{:f}"
        setter:
          q: "CH1:SENS:FREQ {:f}"
        specs:
          min: 10e6
          max: 18e9
          type: float

      channel_2_center_frequency:
        default: 10e6
        getter:
          q: "CH2:SENS:FREQ?"
          r: "{:f}"
        setter:
          q: "CH2:SENS:FREQ {:f}"
        specs:
          min: 10e6
          max: 18e9
          type: float

      channel_3_center_frequency:
        default: 10e6
        getter:
          q: "CH3:SENS:FREQ?"
          r: "{:f}"
        setter:
          q: "CH3:SENS:FREQ {:f}"
        specs:
          min: 10e6
          max: 18e9
          type: float

      channel_4_center_frequency:
        default: 10e6
        getter:
          q: "CH4:SENS:FREQ?"
          r: "{:f}"
        setter:
          q: "CH4:SENS:FREQ {:f}"
        specs:
          min: 10e6
          max: 18e9
          type: float

  SignalGenerator:
    eom:
      ASRL INSTR:
        q: "\r\n"
        r: "\n"
      USB INSTR:
        q: "\n"
        r: "\n"
      TCPIP INSTR:
        q: "\n"
        r: "\n"
      TCPIP SOCKET:
        q: "\n"
        r: "\n"
      GPIB INSTR:
        q: "\n"
        r: "\n"
    error:
      status_register:
        - q: "*ESR?"
          command_error: 32
          query_error: 4

    dialogues:
      - q: "*IDN?"
        r: "FakeTech,Signal Generator #1234,1837518935,v3"
      - q: "TRIG"
      - q: "*RST"
      - q: "FETC?"
        r: "-52.617,-52.373,-52.724,-51.893,-52.27,-52.047,-53.059,-52.053,-52.426,-52.343,-52.228,-52.976,-52.186,-53.0,-51.894,-53.18,-51.96,-52.326,-52.492,-52.871,-52.41,-53.111,-53.199,-52.907,-52.791,-52.68,-51.63,-51.679,-21.743,-52.613,-52.108,-53.138,-52.014,-52.289,-52.235,-52.26,-53.135,-52.503,-52.201,-51.633,-51.933,-52.82,-52.287,-52.594,-51.89,-52.371,-52.068,-51.888,-53.145,-53.085,-52.392,-52.064,-51.688,-52.188,-52.211,-52.226,-52.841,-51.951,-51.573,-51.521,-52.115,-52.302,-52.958,-52.503,-52.32,-52.81,-52.357,-51.729,-52.956,-52.849,-51.883,-51.505,-52.027,-52.234,-52.092,-51.446,-52.798,-51.601,-52.14,-51.477,-52.614,-52.291,-52.532,-52.861,-51.814,-51.821,-52.997,-53.184,-51.761,-53.052,-51.612,-52.876,-52.013,-52.252,-52.059,-52.806,-52.474,-51.689,-52.606,-51.924,-51.964,-51.601,-52.815,-53.172,-52.183,-53.071,-52.763,-52.999,-52.595,-52.463,-52.48,-52.701,-52.337,-51.778,-52.039,-51.493,-51.591,-51.654,-51.525,-52.925,-51.531,-53.169,-52.997,-52.519,-52.298,-52.078,-52.547,-51.518,-51.589,-51.567,-51.502,-51.984,-52.215,-52.681,-51.468,-53.197,-53.007,-51.929,-52.465,-53.132,-52.073,-51.75,-52.8,-52.054,-52.493,-51.605,-53.026,-52.28,-52.331,-52.109,-51.889,-52.878,-51.874,-51.801,-52.031,-52.625,-51.84,-53.029,-52.431,-51.655,-52.51,-52.431,-52.165,-52.009,-51.973,-53.042,-52.632,-51.754,-52.637,-51.757,-51.9,-52.775,-52.49,-52.022,-52.151,-52.05,-51.867,-52.494,-53.014,-52.14,-53.036,-51.799,-51.848,-51.996,-52.254,-52.75,-51.492,-51.755,-52.494,-53.193,-53.114,-53.028,-52.898,-52.992,-53.127,-51.752,-53.065,-52.585,-51.861,-51.596"

    properties:
      center_frequency:
        default: 10e6
        getter:
          q: "SENS:FREQ?"
          r: "{:f}"
        setter:
          q: "SENS:FREQ {:f}"
        specs:
          min: 10e6
          max: 18e9
          type: float

      set_mode:
        default: "tone"
        getter:
          q: "MODE?"
          r: "{:s}"
        setter:
          q: "MODE {:s}"
        specs:
            valid: ["sweep", "tone", "iq"]
            type: str

      output_enable:
        default: 'NO'
        getter:
          q: "OUT:ENABL?"
          r: "{:s}"
        setter:
          q: "OUT:ENABL {:s}"
        specs:
            valid: ["YES", "NO"]
            type: str

resources:
  # ASRL1::INSTR:
  #   device: PowerSensor
  USB::0x1111::0x2222::0x1234::INSTR:
    device: PowerSensor
  USB::0x1111::0x2233::0x9876::INSTR:
    device: Oscilloscope
  USB::0x1111::0x2222::0x4445::INSTR:
    device: SpectrumAnalyzer    
  TCPIP::localhost:10001::INSTR:
    device: SignalGenerator
  # TCPIP::localhost::10001::SOCKET:
  #   device: PowerSensor
  # GPIB::8::INSTR:
  #   device: SpectrumAnalyzer